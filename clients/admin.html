<!DOCTYPE html>
<html lang="ko">
  <head>
    <title>ê´€ë¦¬ì í˜ì´ì§€</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
      body {
        font-family: "Inter", sans-serif;
        background-color: #1f2937;
        color: #f3f4f6;
      }
      .status-waiting {
        border-left-color: #facc15; /* Yellow */
      }
      .status-called {
        border-left-color: #34d399; /* Green */
      }
      /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
      .custom-scrollbar::-webkit-scrollbar {
        width: 8px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #374151;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #6b7280;
        border-radius: 4px;
      }
    </style>
  </head>
  <body class="p-6 md:p-10">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "sans-serif"],
            },
          },
        },
      };
    </script>
    <header class="text-center mb-8">
      <h1 class="text-3xl md:text-4xl font-extrabold text-blue-400 mb-2">
        ëŒ€ê¸°ì—´ ê´€ë¦¬
      </h1>
      <p class="text-lg md:text-xl text-gray-300">
        ì‹¤ì‹œê°„ìœ¼ë¡œ ëŒ€ê¸°ì—´ì„ ê´€ë¦¬í•˜ì„¸ìš”.
      </p>
    </header>
    <main
      class="max-w-7xl mx-auto bg-gray-800 p-6 md:p-8 rounded-xl shadow-2xl"
    >
      <section class="mb-8">
        <h2
          class="text-2xl font-bold border-b border-gray-600 pb-3 mb-4 text-blue-300"
        >
          ë‹¤ìŒ ìˆœì„œ í˜¸ì¶œ
        </h2>
        <div class="flex flex-col md:flex-row gap-4">
          <button
            onclick="callNext()"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-150"
          >
            ë‹¤ìŒ ëŒ€ê¸°ì í˜¸ì¶œ
          </button>
        </div>
      </section>

      <section class="mb-8">
        <h2
          class="text-2xl font-bold border-b border-gray-600 pb-3 mb-4 text-purple-300"
        >
          ê³ ê° ëŒ€ê¸°ì—´
        </h2>
        <div
          class="hidden sm:grid grid-cols-12 text-sm font-semibold text-gray-400 py-2 border-b border-gray-600"
        >
          <span class="col-span-1">ë²ˆí˜¸</span>
          <span class="col-span-3">ì´ë¦„</span>
          <span class="col-span-3">ì „í™”ë²ˆí˜¸</span>
          <span class="col-span-2">ìƒíƒœ</span>
          <span class="col-span-3 text-right">ê´€ë¦¬</span>
        </div>
        <div id="queue-list-container" class="max-h-96 overflow-y-auto">
          <ul id="queue-list" class="space-y-3">
            <li class="text-lg text-gray-400 py-2">
              ëŒ€ê¸°ì—´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...
            </li>
          </ul>
        </div>
      </section>

      <section class="mb-8">
        <h2
          class="text-2xl font-bold border-b border-gray-600 pb-3 mb-4 text-green-300"
        >
          ëŒ€ê¸°ì ìˆ˜ë™ ê´€ë¦¬
        </h2>
        <div class="flex flex-wrap gap-4">
          <div
            id="register-section"
            class="flex-grow bg-gray-700 p-6 rounded-lg shadow-inner flex flex-col items-start space-y-4"
          >
            <h3 class="text-lg font-bold text-gray-200">ê³ ê° ë“±ë¡</h3>
            <input
              type="text"
              id="register-name"
              placeholder="ì´ë¦„"
              class="w-full p-2 rounded bg-gray-600 border border-gray-500 placeholder-gray-400 text-white"
            />
            <input
              type="text"
              id="register-phone"
              placeholder="ì „í™”ë²ˆí˜¸"
              class="w-full p-2 rounded bg-gray-600 border border-gray-500 placeholder-gray-400 text-white"
            />
            <button
              onclick="registerUser()"
              class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 rounded-lg transition duration-150"
            >
              ë“±ë¡
            </button>
          </div>
          <div
            id="specific-call-section"
            class="flex-grow bg-gray-700 p-6 rounded-lg shadow-inner flex flex-col items-start space-y-4"
          >
            <h3 class="text-lg font-bold text-gray-200">íŠ¹ì • ê³ ê° í˜¸ì¶œ</h3>
            <input
              type="text"
              id="call-specific-phone"
              placeholder="ì „í™”ë²ˆí˜¸"
              class="w-full p-2 rounded bg-gray-600 border border-gray-500 placeholder-gray-400 text-white"
            />
            <button
              onclick="callSpecificUser()"
              class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 rounded-lg transition duration-150"
            >
              í˜¸ì¶œ
            </button>
          </div>
        </div>
      </section>

      <section class="mt-8">
        <h2
          class="text-2xl font-bold border-b border-gray-600 pb-3 mb-4 text-yellow-300"
        >
          ë­í‚¹ í˜ì´ì§€ ê´€ë¦¬
        </h2>
        <p class="text-gray-400 mb-4">
            ë­í‚¹ ëª©ë¡ í™•ì¸ ë° ìˆ˜ë™ ì‚­ì œëŠ” ë³„ë„ ë­í‚¹ ê´€ë¦¬ í˜ì´ì§€ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤.
        </p>
        <div class="flex justify-start">
            <button
                onclick="goToRankingPage()"
                class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-lg transition duration-150 flex items-center"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-6 w-6 mr-2"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 19V6l2-2 2 2v13M9 19h12M9 19H3m12-3h-2m2 0V3m-2 2h2m-4 12V3"
                    />
                </svg>
                ë­í‚¹ ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™
            </button>
        </div>
      </section>
      </main>

    <script>
      // API BASE URLì„ ë™ì ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
      const API_BASE_URL =
        window.location.protocol + "//" + window.location.host + "/api/v1";

      const wsProtocol = window.location.protocol === "https:" ? "wss:" : "ws:";
      const websocketUrl = `${wsProtocol}//${window.location.host}/api/v1/queue/ws?mode=full`;

      const queueListElement = document.getElementById("queue-list");
      const registerNameInput = document.getElementById("register-name");
      const registerPhoneInput = document.getElementById("register-phone");
      const callSpecificPhoneInput = document.getElementById(
        "call-specific-phone"
      );

      // ğŸŒŸ ì¶”ê°€: ì™„ë£Œ ì²˜ë¦¬ìš© ë¹„ë°€ë²ˆí˜¸ (í”„ë¡ íŠ¸ì—”ë“œ ìì²´ ê²€ì¦ìš©)
      const COMPLETION_PASSWORD = "1234";

      let ws;
      let GAMES = [];

      /**
       * ì„œë²„ì—ì„œ ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì™€ GAMES ë³€ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
       */
      async function loadGames() {
        try {
          const response = await fetch(`${API_BASE_URL}/games`);
          if (!response.ok) {
            throw new Error("ê²Œì„ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨");
          }
          const data = await response.json();
          GAMES = data.games || [];
          console.log("ê²Œì„ ëª©ë¡ ë¡œë“œ ì™„ë£Œ:", GAMES);
        } catch (error) {
          console.error("ê²Œì„ ëª©ë¡ì„ ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
          alert("ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.");
        }
      }

      function connectWebSocket() {
        // ì–´ë“œë¯¼ í˜ì´ì§€ì´ë¯€ë¡œ mode=fullë¡œ ì—°ê²° ìš”ì²­ (ì „ì²´ ë°ì´í„° ìˆ˜ì‹ )
        ws = new WebSocket(`${websocketUrl}`);
        ws.onmessage = function (event) {
          try {
            const data = JSON.parse(event.data);
            if (data.queue_list) {
              updateQueueDisplay(data.queue_list);
            }
          } catch (e) {
            console.error("WebSocket ë°ì´í„° ì²˜ë¦¬ ì˜¤ë¥˜:", e);
          }
        };
        ws.onopen = () => console.log("WebSocket ì—°ê²° ì„±ê³µ");
        ws.onclose = (event) => {
          console.log("WebSocket ì—°ê²° ì¢…ë£Œ. ì¬ì—°ê²° ì‹œë„...", event.reason);
          // 3ì´ˆ í›„ ì¬ì—°ê²° ì‹œë„
          setTimeout(connectWebSocket, 3000);
        };
        ws.onerror = (error) => {
          console.error("WebSocket ì˜¤ë¥˜ ë°œìƒ:", error);
          ws.close();
        };
      }

      /**
       * ì „í™”ë²ˆí˜¸ë¥¼ XXX-XXXX-XXXX í˜•ì‹ìœ¼ë¡œ í¬ë§·í•©ë‹ˆë‹¤.
       * @param {string} phoneNumber - í¬ë§·í•  ì „í™”ë²ˆí˜¸ (ìˆ«ìë§Œ)
       * @returns {string} í¬ë§·ëœ ì „í™”ë²ˆí˜¸
       */
      function formatPhoneNumber(phoneNumber) {
        if (!phoneNumber) return "";
        const cleanNum = phoneNumber.replace(/[^0-9]/g, "");
        let match;
        if (cleanNum.length === 11) {
          match = cleanNum.match(/^(\d{3})(\d{4})(\d{4})$/);
        } else if (cleanNum.length === 10) {
          match = cleanNum.match(/^(\d{3})(\d{3})(\d{4})$/);
        } else {
          return cleanNum;
        }

        if (match) {
          return `${match[1]}-${match[2]}-${match[3]}`;
        }
        return cleanNum;
      }

      /**
       * ìƒˆ ê³ ê°ì„ ëŒ€ê¸°ì—´ì— ë“±ë¡í•©ë‹ˆë‹¤. (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
       */
      async function registerUser() {
        const name = registerNameInput.value.trim();
        const phone_number = registerPhoneInput.value
          .trim()
          .replace(/[^0-9]/g, "");

        if (!name || !phone_number) {
          alert("ì´ë¦„ê³¼ ì „í™”ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          return;
        }

        try {
          const response = await fetch(`${API_BASE_URL}/queue/register`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, phone_number }),
          });
          const result = await response.json();

          if (!response.ok) {
            throw new Error(result.detail || "ë“±ë¡ ì‹¤íŒ¨");
          }

          alert(`'${name}'ë‹˜ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
          registerNameInput.value = "";
          registerPhoneInput.value = "";
        } catch (error) {
          alert(`ë“±ë¡ ì˜¤ë¥˜: ${error.message}`);
        }
      }

      /**
       * ë‹¤ìŒ ìˆœì„œì˜ ëŒ€ê¸°ìë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
       */
      async function callNext() {
        try {
          const response = await fetch(`${API_BASE_URL}/queue/call-next`, {
            method: "POST",
          });
          const result = await response.json();

          if (!response.ok) {
            throw new Error(result.detail || "í˜¸ì¶œ ì‹¤íŒ¨");
          }

          alert(
            `ë‹¤ìŒ ê³ ê°(${result.called_user_name || "ìµëª…"})ì´ í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤.`
          );
        } catch (error) {
          alert(`í˜¸ì¶œ ì˜¤ë¥˜: ${error.message}`);
        }
      }

      /**
       * íŠ¹ì • ì „í™”ë²ˆí˜¸ë¥¼ ê°€ì§„ ê³ ê°ì„ í˜¸ì¶œí•©ë‹ˆë‹¤. (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
       */
      async function callSpecificUser(phoneNumber) {
        const phone_number = (phoneNumber || callSpecificPhoneInput.value)
          .trim()
          .replace(/[^0-9]/g, "");

        if (!phone_number) {
          alert("ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          return;
        }

        try {
          const response = await fetch(
            `${API_BASE_URL}/queue/call-specific/${phone_number}`,
            { method: "POST" }
          );
          const result = await response.json();

          if (!response.ok) {
            throw new Error(result.detail || "í˜¸ì¶œ ì‹¤íŒ¨");
          }

          alert(`ê³ ê°(${result.called_user_name || "ìµëª…"})ì´ í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤.`);
          if (!phoneNumber) {
            callSpecificPhoneInput.value = "";
          }
        } catch (error) {
          alert(`í˜¸ì¶œ ì˜¤ë¥˜: ${error.message}`);
        }
      }

      /**
       * ğŸŒŸ ìˆ˜ì •: ê³ ê°ì˜ ì„œë¹„ìŠ¤ ì™„ë£Œë¥¼ ì²˜ë¦¬í•˜ê³  ì ìˆ˜ë¥¼ ë­í‚¹ì— ë“±ë¡í•©ë‹ˆë‹¤. (ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ì¶”ê°€)
       */
      async function completeUser(phoneNumber) {
        // 1. ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ë° ê²€ì¦
        const passwordAttempt = prompt("ì™„ë£Œ ì²˜ë¦¬ë¥¼ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        if (passwordAttempt === null) {
            return; // ì‚¬ìš©ìê°€ ì·¨ì†Œë¥¼ ëˆ„ë¥¸ ê²½ìš°
        }

        if (passwordAttempt !== COMPLETION_PASSWORD) {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ ì™„ë£Œ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return; // ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜ ì‹œ ì¢…ë£Œ
        }

        // 2. ê²Œì„ ëª©ë¡ ë¡œë“œ í™•ì¸ (ê¸°ì¡´ ë¡œì§)
        if (GAMES.length === 0) {
          alert("ê²Œì„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
          return;
        }

        // 3. ê²Œì„ ì„ íƒ (ê¸°ì¡´ ë¡œì§)
        const gamePrompt = `ê²Œì„ì„ ì„ íƒí•˜ì„¸ìš” (${GAMES.join(", ")}).`;
        let game = prompt(gamePrompt, GAMES[0]);
        if (game === null) return;
        game = game.trim();

        if (!GAMES.includes(game)) {
          alert(`ìœ íš¨í•˜ì§€ ì•Šì€ ê²Œì„ì…ë‹ˆë‹¤. í—ˆìš©ëœ ê°’: ${GAMES.join(", ")}`);
          return;
        }

        // 4. ì ìˆ˜ ì…ë ¥ ë° ê²€ì¦ (ê¸°ì¡´ ë¡œì§)
        const scoreString = prompt("ê²Œì„ ì ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        if (scoreString === null || scoreString.trim() === "") {
          return;
        }
        const score = parseInt(scoreString);
        if (isNaN(score)) {
          alert("ìœ íš¨í•œ ì ìˆ˜(ìˆ«ì)ë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.");
          return;
        }

        // 5. ì„œë²„ì— ì™„ë£Œ ìš”ì²­ (ê¸°ì¡´ ë¡œì§)
        try {
          const response = await fetch(`${API_BASE_URL}/queue/complete`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              phone_number: phoneNumber,
              score: score,
              game,
            }),
          });
          const result = await response.json();

          if (!response.ok) {
            throw new Error(result.detail || "ì™„ë£Œ ì‹¤íŒ¨");
          }

          alert(result.message || "ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
        } catch (error) {
          alert(`ì™„ë£Œ ì²˜ë¦¬ ì˜¤ë¥˜: ${error.message}`);
        }
      }

      /**
       * ê³ ê°ì˜ ëŒ€ê¸°ì—´ ë“±ë¡ì„ ì·¨ì†Œí•©ë‹ˆë‹¤. (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
       */
      async function cancelUser(phoneNumber, userName) {
        const phone_number = phoneNumber.replace(/[^0-9]/g, "");

        if (
          !confirm(
            `${userName}ë‹˜(${formatPhoneNumber(
              phoneNumber
            )})ì„ ëŒ€ê¸°ì—´ì—ì„œ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`
          )
        ) {
          return;
        }

        try {
          const response = await fetch(`${API_BASE_URL}/queue/cancel`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              phone_number: phone_number,
              name: userName,
            }),
          });

          const result = await response.json();

          if (!response.ok) {
            throw new Error(result.detail || "ì·¨ì†Œ ì‹¤íŒ¨");
          }

          alert(result.message || "ì·¨ì†Œ ìš”ì²­ì´ ì„±ê³µí–ˆìŠµë‹ˆë‹¤.");
        } catch (error) {
          alert(`ì·¨ì†Œ ìš”ì²­ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
        }
      }

      /**
       * ğŸŒŸ ì¶”ê°€: ë­í‚¹ ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” í•¨ìˆ˜
       */
      function goToRankingPage() {
        // ë­í‚¹ í˜ì´ì§€ì˜ URLì„ ê°€ì •í•©ë‹ˆë‹¤. í•„ìš”ì— ë”°ë¼ ìˆ˜ì •í•´ì£¼ì„¸ìš”.
        const rankingPageUrl = "/ranking/admin";
        window.location.href = rankingPageUrl;
      }

      /**
       * WebSocket ë°ì´í„°ë¥¼ ë°›ì•„ ëŒ€ê¸°ì—´ ëª©ë¡ì„ í™”ë©´ì— ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
       */
      function updateQueueDisplay(queueList) {
        queueListElement.innerHTML = "";

        if (queueList.length === 0) {
          const li = document.createElement("li");
          li.className = "text-lg text-gray-400 py-2";
          li.textContent = "í˜„ì¬ ëŒ€ê¸° ì¸ì›ì´ ì—†ìŠµë‹ˆë‹¤.";
          queueListElement.appendChild(li);
          return;
        }

        queueList.forEach((item, index) => {
          const li = document.createElement("li");

          let liClass =
            "grid grid-cols-12 gap-2 sm:gap-4 items-center bg-gray-700 p-4 rounded-lg shadow hover:bg-gray-600 transition duration-150 border-l-4";
          let statusText = "ëŒ€ê¸° ì¤‘";
          let statusClass = "text-yellow-300";

          if (item.status === "called") {
            liClass += " status-called";
            statusText = "í˜¸ì¶œë¨";
            statusClass = "text-green-300";
          } else {
            liClass += " status-waiting";
          }
          li.className = liClass;

          // 1. ë²ˆí˜¸
          const numberDiv = document.createElement("div");
          numberDiv.className = "col-span-1 text-base sm:text-lg font-bold";
          numberDiv.textContent = `${index + 1}.`;

          // 2. ì´ë¦„
          const nameDiv = document.createElement("div");
          nameDiv.className =
            "col-span-3 text-base sm:text-lg font-semibold truncate";
          nameDiv.textContent = item.name;

          // 3. ì „í™”ë²ˆí˜¸ (ì¶”ê°€ëœ ë¶€ë¶„)
          const phoneDiv = document.createElement("div");
          phoneDiv.className = "col-span-3 text-sm sm:text-base text-gray-400";
          phoneDiv.textContent = formatPhoneNumber(item.phone_number);

          // 4. ìƒíƒœ
          const statusDiv = document.createElement("div");
          statusDiv.className = `col-span-2 text-sm sm:text-base font-medium ${statusClass}`;
          statusDiv.textContent = statusText;

          // 5. ë²„íŠ¼
          const buttonDiv = document.createElement("div");
          buttonDiv.className = "col-span-3 flex justify-end space-x-2";

          // 'waiting' ìƒíƒœì¼ ë•Œë§Œ 'í˜¸ì¶œ' ë²„íŠ¼ í‘œì‹œ
          if (item.status === "waiting") {
            const callButton = document.createElement("button");
            callButton.className =
              "bg-yellow-500 hover:bg-yellow-600 text-white text-sm font-bold py-1 px-2 rounded transition duration-150";
            callButton.textContent = "í˜¸ì¶œ";
            callButton.onclick = () => callSpecificUser(item.phone_number);
            buttonDiv.appendChild(callButton);
          }

          const completeButton = document.createElement("button");
          completeButton.className =
            "bg-green-600 hover:bg-green-700 text-white text-sm font-bold py-1 px-2 rounded transition duration-150";
          completeButton.textContent = "ì™„ë£Œ";
          completeButton.onclick = () => completeUser(item.phone_number);

          const cancelButton = document.createElement("button");
          cancelButton.className =
            "bg-red-500 hover:bg-red-600 text-white text-sm font-bold py-1 px-2 rounded transition duration-150";
          cancelButton.textContent = "ì·¨ì†Œ";
          cancelButton.onclick = () => cancelUser(item.phone_number, item.name);

          buttonDiv.appendChild(completeButton);
          buttonDiv.appendChild(cancelButton);

          li.appendChild(numberDiv);
          li.appendChild(nameDiv);
          li.appendChild(phoneDiv); // ì „í™”ë²ˆí˜¸ ì¶”ê°€
          li.appendChild(statusDiv);
          li.appendChild(buttonDiv);

          queueListElement.appendChild(li);
        });
      }

      // ğŸš¨ ì•± ì‹œì‘ ì‹œ ê²Œì„ ëª©ë¡ì„ ë¨¼ì € ë¡œë“œí•˜ê³  WebSocket ì—°ê²° ì‹œì‘
      loadGames().then(() => {
        connectWebSocket();
      });
    </script>
  </body>
</html>